<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.text.Text?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.shape.Rectangle?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.ibrasoft.jdriveclonr.ui.DownloadController"
            prefWidth="1000" prefHeight="700"
            minWidth="900" minHeight="600"
            stylesheets="@../styles/dark/download.css">

    <!-- Top: Header Section -->
    <top>
        <VBox spacing="8.0" BorderPane.alignment="CENTER" styleClass="download-header">
            <VBox spacing="8.0" styleClass="download-header-content">

                <!-- Header Title Section -->
                <HBox alignment="CENTER_LEFT" spacing="16">
                    <StackPane>
                        <Rectangle width="48" height="48" arcWidth="12" arcHeight="12" 
                                  styleClass="download-icon-container"/>
                        <Text text="↓" styleClass="download-icon"/>
                    </StackPane>
                    <VBox spacing="6">
                        <Text text="Downloading your Files..." styleClass="download-title">
                            <font>
                                <Font name="System Bold" size="24.0" />
                            </font>
                        </Text>
                        <Text text="This will take a while, hang tight!" styleClass="download-subtitle"/>
                    </VBox>
                </HBox>

                <!-- Overall Progress Section -->
                <VBox spacing="12.0" VBox.vgrow="NEVER" styleClass="progress-section">

                    <HBox spacing="12.0" alignment="CENTER_LEFT">
                        <Label fx:id="overallLabel" text="Preparing downloads…" styleClass="progress-label"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="percentLabel" text="0%" styleClass="percent-label"/>
                    </HBox>

                    <StackPane>
                        <ProgressBar fx:id="overallBar" styleClass="overall-progress-bar"/>
                    </StackPane>
                </VBox>
            </VBox>
        </VBox>
    </top>

    <!-- Center: Downloads List Section -->
    <center>
        <VBox spacing="20" BorderPane.alignment="CENTER" VBox.vgrow="ALWAYS" styleClass="download-center-content">

            <!-- Download List Header -->
            <HBox alignment="CENTER_LEFT" spacing="12" styleClass="download-list-header">
                <StackPane>
                    <Rectangle width="28" height="28" arcWidth="6" arcHeight="6" 
                              styleClass="section-icon-container"/>
                    <Text text="▼" styleClass="section-icon"/>
                </StackPane>
                <Text text="Active Downloads" styleClass="section-title"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="threadsCountLabel" text="0 files" styleClass="thread-count-label"/>
            </HBox>

            <!-- Download List Container -->
            <StackPane VBox.vgrow="ALWAYS" styleClass="download-list-container">
                
                <!-- Active Downloads List -->
                <ListView fx:id="threadList" styleClass="download-list-view"/>

                <!-- Empty State -->
                <StackPane fx:id="emptyStatePane" visible="false">
                    <VBox alignment="CENTER" spacing="16">
                        <StackPane>
                            <Rectangle width="80" height="80" arcWidth="20" arcHeight="20" 
                                      styleClass="empty-state-icon-container"/>
                            <Text text="↓" styleClass="empty-state-icon"/>
                        </StackPane>
                        <VBox alignment="CENTER" spacing="4">
                            <Label text="No active downloads" styleClass="empty-state-title"/>
                            <Label text="Downloads will appear here when they start" styleClass="empty-state-subtitle"/>
                        </VBox>
                    </VBox>
                </StackPane>
            </StackPane>
            
            <!-- Completed Downloads Section -->
            <HBox fx:id="completedHeaderBox" alignment="CENTER_LEFT" spacing="12" visible="false" managed="false">
                <StackPane>
                    <Rectangle width="28" height="28" arcWidth="6" arcHeight="6" 
                               styleClass="completed-icon-container"/>
                    <Text text="✓" styleClass="completed-icon"/>
                </StackPane>
                <Text text="Completed Downloads" styleClass="completed-title"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="completedCountLabel" text="0 files" styleClass="completed-count-label"/>
            </HBox>

            <!-- Completed Downloads Container -->
            <StackPane VBox.vgrow="SOMETIMES" styleClass="completed-container"
                      visible="false" managed="false" fx:id="completedDownloadsPane">
                <ScrollPane fitToWidth="true" styleClass="completed-scroll-pane">
                    <ListView fx:id="completedList" styleClass="completed-list-view"/>
                </ScrollPane>
            </StackPane>
            
            <!-- Failed Downloads Section -->
            <HBox fx:id="failedHeaderBox" alignment="CENTER_LEFT" spacing="12" visible="false" managed="false">
                <StackPane>
                    <Rectangle width="28" height="28" arcWidth="6" arcHeight="6" 
                               styleClass="failed-icon-container"/>
                    <Text text="⚠" styleClass="failed-icon"/>
                </StackPane>
                <Text text="Failed Downloads" styleClass="failed-title"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="failedCountLabel" text="0 files" styleClass="failed-count-label"/>
            </HBox>

            <!-- Failed Downloads Container -->
            <StackPane VBox.vgrow="SOMETIMES" styleClass="failed-container"
                      visible="false" managed="false" fx:id="failedDownloadsPane">
                <ScrollPane fitToWidth="true" styleClass="failed-scroll-pane">
                    <ListView fx:id="failedList" styleClass="failed-list-view"/>
                </ScrollPane>
            </StackPane>
        </VBox>
    </center>

    <!-- Bottom: Action Buttons -->
    <bottom>
        <HBox spacing="16.0" alignment="CENTER_RIGHT" styleClass="download-bottom-section">

            <HBox spacing="12" alignment="CENTER_LEFT" HBox.hgrow="ALWAYS">
                <StackPane>
                    <Rectangle width="20" height="20" arcWidth="4" arcHeight="4" 
                              styleClass="info-icon-container"/>
                    <Text text="i" styleClass="info-icon"/>
                </StackPane>
                <Label text="Download Service v1.0" styleClass="version-label"/>
            </HBox>

            <Button fx:id="cancelBtn" text="Cancel Download" onAction="#cancelDownload" styleClass="cancel-button"/>

            <Button fx:id="closeBtn" text="Close" onAction="#closeWindow" styleClass="close-button"/>
        </HBox>
    </bottom>

</BorderPane>